version: 2.1

# Orbs are reusable packages of CircleCI configuration that you may share across projects, enabling you to create encapsulated, parameterized commands, jobs, and executors that can be used across multiple projects.
# See: https://circleci.com/docs/orb-intro/
orbs:
  node: circleci/node@4.7
  
workflows:
  sample:
    jobs:
      - node/test:
          version: '16.10'
          pkg-manager: npm
      -  build:
          docker:
            - image: circleci/buildpack-deps:stretch
          steps:
            - checkout
            - setup_remote_docker
            - run:
                name: Build Docker image
                command: docker build -t medinvention/my-velero-dashboard:dev .
      - publish:
          docker:
            - image: circleci/buildpack-deps:stretch
          steps:
            - setup_remote_docker
            - run:
                name: Publish Docker Image to Docker Hub
                command: |
                  echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
                  docker push medinvention/my-velero-dashboard:dev
